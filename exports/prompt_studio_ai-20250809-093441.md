# Lucra — Correção de Extração (Studio AI)

## Contexto
Você irá **extrair sinais de trade** de prints/JSON e devolvê-los neste **schema imutável**. O auditor do Lucra valida todos os campos e rotula erros.

## Schema e Regras
```
Campos obrigatórios por sinal:
{
  "symbol": "TICKERUSDT",
  "side": "BUY|SELL",
  "entry": number,
  "target": number,
  "stop_loss": number,
  "entrada_datahora": "YYYY-MM-DD HH:MM:SS",
  "saida_datahora":   "YYYY-MM-DD HH:MM:SS"
}
Regras:
- BUY: target > entry e stop_loss < entry
- SELL: target < entry e stop_loss > entry
- Datas válidas (UTC) no formato acima
- Símbolo deve existir na Binance (exchangeInfo=status TRADING)
Erros padronizados: E_NUM, E_SIDE, E_DATE, E_SYMBOL, E_PRICE_MISS, E_RULE_BUY, E_RULE_SELL, E_NET
```

## Métricas recentes (janela 7d)
- Amostras: 7909
- Inválidos: 0.3%
- Cobertura de preço (informativo): 99.6%
- Finalizados: 6
- Acurácia final (proxy): 0.5

## Top erros
- E_SYMBOL: 24

## Tarefa
1. **Produza o JSON do sinal** exatamente no schema.
2. **Normalize** side (BUY/SELL), numéricos (ponto decimal) e datas (YYYY-MM-DD HH:MM:SS UTC).
3. **Valide regras** (BUY/SELL) antes de responder.
4. **Não inclua** campos extras nem preço ao vivo.
5. **Se o input estiver ambíguo**, responda com um objeto contendo `__issue` e uma explicação curta.

## Exemplos de falha e como corrigir
### Exemplo 1 — E_SYMBOL
Sinal:
```json
{
  "symbol": "MATICUSDT",
  "side": "SELL",
  "entry": 0.38,
  "target": 0.35,
  "stop_loss": 0.39,
  "entrada_datahora": "2025-08-08 22:22:32",
  "saida_datahora": "2025-08-09 22:22:32"
}
```
Erros do auditor: E_SYMBOL
Dica: Use o par negociado na Binance (ex.: BTCUSDT).

Saída esperada:
- Gerar JSON exatamente no schema abaixo, com valores coerentes às regras (BUY/SELL) e datas válidas.
- Não incluir campos extras nem preço ao vivo.

### Exemplo 2 — E_SYMBOL
Sinal:
```json
{
  "symbol": "MATICUSDT",
  "side": "BUY",
  "entry": 0.38,
  "target": 0.45,
  "stop_loss": 0.34,
  "entrada_datahora": "2025-08-08 20:56:05",
  "saida_datahora": "2025-08-15 20:56:05"
}
```
Erros do auditor: E_SYMBOL
Dica: Use o par negociado na Binance (ex.: BTCUSDT).

Saída esperada:
- Gerar JSON exatamente no schema abaixo, com valores coerentes às regras (BUY/SELL) e datas válidas.
- Não incluir campos extras nem preço ao vivo.

### Exemplo 3 — E_SYMBOL
Sinal:
```json
{
  "symbol": "MATICUSDT",
  "side": "SELL",
  "entry": 0.39,
  "target": 0.25,
  "stop_loss": 0.42,
  "entrada_datahora": "2025-08-08 20:56:05",
  "saida_datahora": "2026-08-08 20:56:05"
}
```
Erros do auditor: E_SYMBOL
Dica: Use o par negociado na Binance (ex.: BTCUSDT).

Saída esperada:
- Gerar JSON exatamente no schema abaixo, com valores coerentes às regras (BUY/SELL) e datas válidas.
- Não incluir campos extras nem preço ao vivo.
